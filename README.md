# XILLEN Privilege Escalation Scanner

## Описание

XILLEN Privilege Escalation Scanner - это мощный инструмент для обнаружения векторов повышения привилегий в Windows-системах. Инструмент проводит комплексный анализ системы, выявляя уязвимости в службах, задачах, реестре, драйверах, процессах и сетевых настройках, которые могут быть использованы для получения повышенных привилегий.

## Возможности

### Анализ системы
- **Системная информация**: ОС, архитектура, компьютер, домен, память, процессоры
- **Привилегии пользователя**: Текущий пользователь, SID, права администратора, группы
- **Записываемые директории**: Поиск директорий с правами на запись

### Обнаружение уязвимостей
- **Службы**: Уязвимые службы с записываемыми директориями
- **Планировщик задач**: Задачи с правами SYSTEM и записываемыми директориями
- **Реестр**: Ключи реестра с правами на модификацию
- **Драйверы**: Уязвимые драйверы с записываемыми директориями
- **Процессы**: Процессы с записываемыми директориями
- **Сеть**: Привилегированные порты и уязвимые сетевые ресурсы

### Функции безопасности
- Цветной вывод для лучшей читаемости
- Детальный анализ прав доступа
- Генерация предложений по эксплуатации
- Сохранение результатов в JSON
- Обработка ошибок и исключений

## Установка

### Требования
- Windows PowerShell 5.0 или выше
- Windows 7/8/10/11 или Windows Server 2008+
- Права на выполнение скриптов PowerShell

### Настройка выполнения скриптов
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

## Использование

### Основные команды

#### Базовое сканирование
```powershell
.\PrivilegeEscalation.ps1
```

#### Сканирование с сохранением результатов
```powershell
.\PrivilegeEscalation.ps1 -OutputFile "scan_results.json"
```

#### Подробный вывод
```powershell
.\PrivilegeEscalation.ps1 -Verbose
```

#### Сканирование удаленной системы
```powershell
.\PrivilegeEscalation.ps1 -Target "192.168.1.100" -Username "admin" -Password "password"
```

### Параметры командной строки

- `-Target`: Целевая система (по умолчанию: localhost)
- `-Username`: Имя пользователя для удаленного подключения
- `-Password`: Пароль для удаленного подключения
- `-Domain`: Домен для аутентификации
- `-LocalOnly`: Сканировать только локальную систему
- `-RemoteOnly`: Сканировать только удаленные системы
- `-Verbose`: Подробный вывод
- `-OutputFile`: Файл для сохранения результатов

## Примеры использования

### Пример 1: Базовое сканирование
```powershell
.\PrivilegeEscalation.ps1
```

### Пример 2: Сканирование с сохранением результатов
```powershell
.\PrivilegeEscalation.ps1 -OutputFile "privilege_escalation_report.json"
```

### Пример 3: Подробное сканирование
```powershell
.\PrivilegeEscalation.ps1 -Verbose -OutputFile "detailed_scan.json"
```

### Пример 4: Сканирование удаленной системы
```powershell
.\PrivilegeEscalation.ps1 -Target "192.168.1.100" -Username "pentester" -Password "SecurePass123!" -OutputFile "remote_scan.json"
```

## Выходные данные

### Структура результатов
```json
{
  "Timestamp": "2024-01-15 14:30:25",
  "SystemInfo": {
    "OS": {...},
    "Computer": {...}
  },
  "UserInfo": {
    "Username": "user@domain",
    "SID": "S-1-5-21-...",
    "IsAdmin": false,
    "Groups": [...]
  },
  "WritableDirectories": [...],
  "ServiceVulnerabilities": [...],
  "TaskVulnerabilities": [...],
  "RegistryVulnerabilities": [...],
  "DriverVulnerabilities": [...],
  "ProcessVulnerabilities": [...],
  "NetworkVulnerabilities": [...],
  "ExploitSuggestions": [...]
}
```

### Примеры уязвимостей

#### Уязвимая служба
```json
{
  "Name": "VulnerableService",
  "DisplayName": "Vulnerable Service",
  "Path": "C:\\Program Files\\Service\\service.exe",
  "Directory": "C:\\Program Files\\Service",
  "StartName": "LocalSystem",
  "Vulnerability": "Writable service directory"
}
```

#### Уязвимый ключ реестра
```json
{
  "Path": "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
  "Identity": "DOMAIN\\user",
  "Rights": "SetValue, CreateSubKey",
  "Vulnerability": "Writable registry key"
}
```

## Обнаруживаемые уязвимости

### Высокий риск
- **Службы с правами SYSTEM**: Записываемые директории служб
- **Планировщик задач**: Задачи с правами SYSTEM
- **Ключи автозапуска**: Модифицируемые ключи Run/RunOnce
- **Драйверы**: Записываемые директории драйверов

### Средний риск
- **Процессы**: Записываемые директории процессов
- **Сетевые ресурсы**: Записываемые сетевые ресурсы
- **Привилегированные порты**: Прослушивание портов < 1024

### Низкий риск
- **Временные директории**: Записываемые временные директории
- **Пользовательские директории**: Записываемые пользовательские директории

## Рекомендации по безопасности

### Для системных администраторов
- Регулярно проверяйте права доступа к системным директориям
- Ограничивайте права пользователей на критические ресурсы
- Мониторьте изменения в службах и задачах
- Используйте принцип наименьших привилегий

### Для пентестеров
- Проводите регулярные проверки на векторы повышения привилегий
- Документируйте все найденные уязвимости
- Тестируйте исправления в безопасной среде
- Используйте инструмент как часть комплексной оценки безопасности

## Требования

- **Операционная система**: Windows 7/8/10/11, Windows Server 2008+
- **PowerShell**: Версия 5.0 или выше
- **Права**: Пользователь с правами на чтение системной информации
- **Память**: Минимум 256 MB RAM
- **Дисковое пространство**: 50 MB для скрипта и результатов

## Производительность

### Оптимизации
- Эффективные WMI-запросы
- Параллельная обработка данных
- Кэширование результатов
- Оптимизированные проверки прав доступа

### Метрики
- **Локальное сканирование**: 30-60 секунд
- **Удаленное сканирование**: 1-5 минут (зависит от сети)
- **Память**: 50-100 MB
- **CPU**: 10-30% во время сканирования

## Безопасность

### Предупреждения
- **ТОЛЬКО ДЛЯ ТЕСТИРОВАНИЯ**: Используйте только в разрешенных средах
- **Права доступа**: Скрипт требует минимальных прав для работы
- **Логирование**: Все действия могут логироваться системой
- **Сетевой трафик**: Удаленное сканирование генерирует сетевой трафик

### Рекомендации
- Запускайте в изолированной среде
- Используйте временные учетные записи
- Ограничивайте доступ к результатам сканирования
- Соблюдайте политики безопасности организации

## Авторы

- **@Bengamin_Button** - Основной разработчик
- **@XillenAdapter** - Консультант по безопасности

## Ссылки

- **Веб-сайт**: https://benjaminbutton.ru/
- **Платформа**: https://xillenkillers.ru/
- **Telegram**: t.me/XillenAdapter
